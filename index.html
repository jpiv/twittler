<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel='stylesheet' href="style.css" type='text/css'>
  </head>
  <body>
    <div id="frame">
      <div id="home"></div>
      <div id="profile">
          <h1>Profile</h1>
      </div>
    </div>

    <script>

      $(document).ready(function(){
        var printTweets = function (stream, target, start)
        {
            var origHtml = start || ' ';          
            target.html(start);

            var index = stream.length - 1;
            while(index >= 0){
              var tweet = stream[index];
              var $tweet = $('<div></div>');
              var $anchor = $('<a href="#" data-usr="' + tweet.user +'"" class="user">' + tweet.user + '</a>');
              $tweet.text('[' + tweet.created_at.toDateString() + ']@');
              $tweet.append($anchor);
              $tweet.append($('<span>: ' + tweet.message + '</span>'));
              $tweet.appendTo(target);
              index -= 1;
            }
            $()
            addListeners();
        };

        var addListeners = function ()
        {
            $('.user').on('click', function (event)
              {
                  event.preventDefault();
                  var user = $(this).data('usr');
                  var start = $("<div>"
                                 + "<h1>Profile</h1>"
                                  + "@" + user + '<br><br>');

                  printTweets(streams.users[user], $('#profile'), start);
              });
        }

        printTweets(streams.home, $('#home')); 
        setInterval(function()
          {   
              printTweets(streams.home, $('#home'), false);
          },1500);
      });

    </script>
  </body>
</html>
